<?xml version="1.0" encoding="UTF-8"?>
<openerp>
	<data>

        <!--&lt;!&ndash; Partner Form View &ndash;&gt;-->
        <!--<record id="view_partner_form" model="ir.ui.view">-->
            <!--<field name="name">partner.clients</field>-->
            <!--<field name="model">res.partner</field>-->
            <!--<field name="inherit_id" ref="base.view_partner_form"/>-->
            <!--<field name="arch" type="xml">-->
                <!--<notebook position="inside">-->
                    <!--<page string="Fleet partner" invisible="context.get('is_fleet_client', False) or context.get('is_fleet_retailer', False)">-->
                        <!--<group>-->
                            <!--<div class="oe_edit_only">-->
                                <!--<label for="Fleet Partner"/>-->
                                    <!--<field name="is_fleet_client" class="oe_inline"/>-->
                                    <!--<label for="is_fleet_client" string="Is a Fleet Client?"/>-->
                                    <!--<field name="is_fleet_retailer" class="oe_inline"/>-->
                                    <!--<label for="is_fleet_retailer" string="Is a Fleet Retailer?"/>-->
                            <!--</div>-->
                        <!--</group>-->
                    <!--</page>-->
                <!--</notebook>-->
            <!--</field>-->
        <!--</record>-->

        <!-- Client Form View -->
        <record id="fleet_ext.client_form_view" model="ir.ui.view">
            <field name="name">fleet.clients</field>
            <field name="model">fleet.client</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
                <xpath expr="//div[@name='buttons']" position="inside">
                    <button class="oe_inline oe_stat_button" type="action" name="%(fleet.fleet_vehicle_log_contract_act)d"
                        context="{'search_default_partner_id': active_id, 'default_partner_id': active_id}"
                        icon="fa-linux">
                        <field  string="Contract" name="contract_count" widget="statinfo"/>
                    </button>
                </xpath>
                <field name="parent_id" position="replace">
                    <field name="parent_id"
                           domain="[('is_company', '=', True)]"
                           context="{'form_view_ref': 'fleet_ext.client_form_view', 'default_is_company': True, 'default_supplier': supplier, 'default_customer': customer}"
                           attrs="{'invisible': [('is_company','=', True),('parent_id', '=', False)]}"
                           on_change="onchange_address(use_parent_address, parent_id)"/>
                </field>
                <notebook position="inside">
                    <page string="Client Info" autofocus="autofocus">  <!--autofocus work on odoo 9+-->
                        <group>
                            <field name="is_fleet_active"/>
                            <field name="date_begin"/>
                            <field name="date_terminated"/>
                            <field name="birthdate"/>
                            <field name="lang"/>
                        </group>
                    </page>
                    <page string="Vehicles">
                        <field name="vehicle_ids" />
                    </page>
                    <page string="Follow-up">
                        <group>
                            <field name="lost_reason"/>
                            <field name="lost_date"/>
                            <field name="competitor"/>
                            <field name="end_date_of_follow_up"/>
                            <field name="return_arr"/>
                        </group>
                    </page>
                </notebook>
            </field>
        </record>

        <!-- Retailer Form View -->
        <record id="fleet_ext.retailer_form_view" model="ir.ui.view">
            <field name="name">fleet.retailer</field>
            <field name="model">fleet.retailer</field>
            <field name="inherit_id" ref="base.view_partner_form"/>
            <field name="mode">primary</field>
            <field name="arch" type="xml">
                <notebook position="inside">
                    <page string="Clients">
                        <!--todo ajouter client_ids-->
                    </page>
                    <page string="Vehicles" autofocus="autofocus"> <!--autofocus work on odoo 9+-->
                        <field name="fleet_vehicle_ids" />
                    </page>
                </notebook>
            </field>
        </record>

        <!-- Retailer actions-->
        <record id="action_fleet_retailers" model="ir.actions.act_window">
            <field name="name">Retailers</field>
            <field name="res_model">fleet.retailer</field>
            <!--<field name="search_view_id" ref="view_res_partner_retailer_filter"/>-->
            <!--<field name="context">{"is_fleet_retailer": True}</field>-->
            <!--<field name="domain" eval="[('is_fleet_retailer', '=', True)]"/>-->
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a retailer in your address book.
                </p>
            </field>
        </record>

		<!-- Client actions-->
        <record id="action_fleet_clients" model="ir.actions.act_window">
            <field name="name">Clients</field>
            <field name="res_model">fleet.client</field>
            <!--<field name="search_view_id" ref="view_res_partner_client_filter"/>-->
            <!--<field name="context">{"is_fleet_client": True}</field>-->
            <!--<field name="domain" eval="[('is_fleet_client', '=', True)]"/>-->
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a client in your address book.
                </p>
            </field>
        </record>

        <!--retailer view type-->
        <record id="action_fleet_retailers_kanban" model="ir.actions.act_window.view">
            <field eval="0" name="sequence"/>
            <field name="view_mode">kanban</field>
            <!--<field name="view_id" ref="base.res_partner_kanban_view"/>-->
            <field name="act_window_id" ref="action_fleet_retailers"/>
        </record>

        <record id="action_fleet_retailers_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <!--<field name="view_id" ref="fleet_ext.retailer_tree_view"/> -->
            <field name="act_window_id" ref="action_fleet_retailers"/>
        </record>

        <record id="action_fleet_retailers_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="retailer_form_view"/>
            <field name="act_window_id" ref="action_fleet_retailers"/>
        </record>

        <!--client view type-->
        <record id="action_fleet_clients_kanban" model="ir.actions.act_window.view">
            <field eval="0" name="sequence"/>
            <field name="view_mode">kanban</field>
            <!--<field name="view_id" ref="base.res_partner_kanban_view"/>-->
            <field name="act_window_id" ref="action_fleet_clients"/>
        </record>

        <record id="action_fleet_clients_tree" model="ir.actions.act_window.view">
            <field eval="1" name="sequence"/>
            <field name="view_mode">tree</field>
            <!--<field name="view_id" ref="fleet_ext.client_tree_view"/> -->
            <field name="act_window_id" ref="action_fleet_clients"/>
        </record>

        <record id="action_fleet_clients_form" model="ir.actions.act_window.view">
            <field eval="2" name="sequence"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="client_form_view"/>
            <field name="act_window_id" ref="action_fleet_clients"/>
        </record>

        <!-- Fleet Retailer and Fleet Client filters in contact view -->
        <!--<record id="view_res_partner_filter_inherit" model="ir.ui.view">-->
            <!--<field name="name">res.partner.fleet_ext.inherit.search</field>-->
            <!--<field name="model">res.partner</field>-->
            <!--<field name="inherit_id" ref="base.view_res_partner_filter"/>-->
            <!--<field name="arch" type="xml">-->
                <!--<group string="Group By" position="before">-->
                    <!--<group string="Fleet">-->
                        <!--<filter name="fleet_retailer" domain="[('is_fleet_retailer', '=', 1)]" string="Retailer" />-->
                        <!--<filter name="fleet_clients" domain="[('is_fleet_client', '=', 1)]" string="Clients" />-->
                    <!--</group>-->
                <!--</group>-->
            <!--</field>-->
        <!--</record>-->

        <!-- Fleet Client filters in Fleet Client view -->
        <record id="view_res_partner_fleet_client_filter" model="ir.ui.view">
            <field name="name">res.partner.fleet_client.search</field>
            <field name="model">res.partner</field>
            <field name="arch" type="xml">
                <search string="Search Partner" position="replace">
                    <field name="name"
                       filter_domain="['|','|',('display_name','ilike',self),('ref','=',self),('email','ilike',self)]"/>
                    <filter help="My Partners" icon="terp-personal+" domain="[('user_id','=',uid)]"/>
                    <separator/>
                    <filter string="Persons" name="type_person" domain="[('is_company','=',0)]"/>
                    <filter string="Companies" name="type_company" domain="[('is_company','=',1)]"/>
                    <separator/>
                    <group string="Group By">
                        <filter string="Country" context="{'group_by': 'country_id'}"/>
                    </group>
                </search>
            </field>
        </record>

        <!--menu-->
        <menuitem name="Retailer" parent="fleet.menu_root" id="menu_fleet_retailer" sequence="2" groups="fleet.group_fleet_manager"/>
		<!--menu action-->
        <menuitem action="action_fleet_retailers" name="Retailers" parent="menu_fleet_retailer" id="fleet_retailer_menu" groups="fleet.group_fleet_manager"/>
        <menuitem action="action_fleet_clients" name="Clients" parent="menu_fleet_retailer" id="fleet_client_menu" sequence="2" groups="fleet.group_fleet_manager"/>
        <!--<menuitem action="action_fleet_members" name="Members" parent="menu_fleet" id="menu_members" sequence="2" />-->

	</data>
</openerp>
